â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘              Using Custom Pretrained Weights (--weights)             â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

NEW FEATURE: Load custom pretrained models for fine-tuning!

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ USE CASES

1. Fine-tuning from a previous training run
   â†’ Continue training from your best checkpoint

2. Transfer learning
   â†’ Start from a model trained on similar data

3. Resuming interrupted training
   â†’ Pick up where you left off

4. Experimenting with different starting points
   â†’ Try different base models

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“‹ USAGE

Basic syntax:
  python train_vm.py --weights PATH/TO/MODEL.pt

Examples:

1. Use your previous best model:
   python train_vm.py --weights runs/yolov11_wildlife/weights/best.pt --epochs 50

2. Use last checkpoint (if training was interrupted):
   python train_vm.py --weights runs/yolov11_wildlife/weights/last.pt --epochs 50

3. Use absolute path:
   python train_vm.py --weights /full/path/to/your/model.pt --epochs 20

4. Fine-tune with smaller batch for higher resolution:
   python train_vm.py --weights runs/yolov11_wildlife/weights/best.pt --batch 2 --imgsz 2048

5. Combined with other options:
   python train_vm.py \
     --weights runs/yolov11_wildlife/weights/best.pt \
     --epochs 30 \
     --batch 4 \
     --imgsz 2048 \
     --wandb-key YOUR_KEY

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ”§ SUPPORTED MODEL TYPES

âœ… YOLOv11 checkpoints (.pt files):
   - best.pt (best model from training)
   - last.pt (last epoch checkpoint)
   - epoch_N.pt (checkpoint from specific epoch)
   - yolo11[n/s/m/l/x].pt (official pretrained models)

âœ… Custom trained models:
   - Any .pt file from Ultralytics YOLO training

âŒ NOT supported:
   - Other frameworks (TensorFlow, PyTorch native, etc.)
   - Wrong architecture (YOLOv8, YOLOv5, etc. may not work)
   - OBB models if your dataset uses regular boxes

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ WHERE TO FIND CHECKPOINT FILES

After training, your checkpoints are saved in:

runs/yolov11_wildlife/weights/
â”œâ”€â”€ best.pt      â† Best model (highest mAP) â­ USE THIS
â”œâ”€â”€ last.pt      â† Last epoch
â”œâ”€â”€ epoch_5.pt   â† Checkpoint at epoch 5
â”œâ”€â”€ epoch_10.pt  â† Checkpoint at epoch 10
â””â”€â”€ ...

Default location:
  /home/estudiante/grupo_12/subsaharian_dataset/yolo_vm/runs/yolov11_wildlife/weights/

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âš¡ QUICK START

# Scenario 1: Continue from your best model
cd /home/estudiante/grupo_12/subsaharian_dataset/yolo_vm
conda activate yolov11-wildlife

python train_vm.py \
  --weights runs/yolov11_wildlife/weights/best.pt \
  --epochs 30 \
  --batch 4

# Scenario 2: Training was interrupted, resume from last checkpoint
python train_vm.py \
  --weights runs/yolov11_wildlife/weights/last.pt \
  --epochs 50

# Scenario 3: Try different image size with your best model
python train_vm.py \
  --weights runs/yolov11_wildlife/weights/best.pt \
  --imgsz 1024 \
  --batch 8 \
  --epochs 20

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ BEST PRACTICES

1. Always use best.pt for fine-tuning
   â†’ It has the best validation performance

2. Use fewer epochs when fine-tuning
   â†’ Model is already trained, 20-50 epochs often enough
   â†’ Starting from scratch typically needs 50-100 epochs

3. Consider reducing learning rate (advanced)
   â†’ Fine-tuning benefits from lower learning rate
   â†’ YOLO's auto optimizer handles this, but you can adjust

4. Monitor metrics closely
   â†’ Fine-tuning should show immediate improvements
   â†’ If metrics don't improve, check data/configuration

5. Experiment with different hyperparameters
   â†’ Try different batch sizes
   â†’ Try different image sizes
   â†’ Adjust augmentation settings

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š EXPECTED BEHAVIOR

When using custom weights, you'll see:

âœ“ Using custom pretrained weights: runs/yolov11_wildlife/weights/best.pt

Loading model: /path/to/runs/yolov11_wildlife/weights/best.pt
  â†’ Fine-tuning from custom checkpoint

Configuration:
  Model: /path/to/runs/yolov11_wildlife/weights/best.pt
  Training mode: Fine-tuning from custom weights
  Classes: ['Buffalo', 'Elephant', 'Kudu', 'Topi', 'Warthog', 'Waterbuck']

Training should start immediately with loaded weights.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âŒ TROUBLESHOOTING

ERROR: "Weights file not found"
CAUSE: Path is incorrect or file doesn't exist
FIX: 
  - Check the path: ls runs/yolov11_wildlife/weights/
  - Use absolute path if relative path fails
  - Ensure you've completed at least one training run

ERROR: "Model architecture mismatch"
CAUSE: Trying to load incompatible model
FIX:
  - Ensure model was trained with same YOLO version
  - Check that model has same number of classes (6)
  - Use models trained with Ultralytics YOLO only

ERROR: "CUDA out of memory" (when fine-tuning)
CAUSE: Model + data too large for GPU
FIX:
  - Reduce batch size: --batch 2 or --batch 1
  - Reduce image size: --imgsz 1024
  - Clear GPU cache: nvidia-smi --gpu-reset

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ”„ COMPARISON: Base Model vs Custom Weights

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Starting from Base Model (default)                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ python train_vm.py --epochs 50                                     â”‚
â”‚                                                                    â”‚
â”‚ â€¢ Starts from yolo11s.pt (pretrained on COCO)                     â”‚
â”‚ â€¢ Learns wildlife detection from scratch                          â”‚
â”‚ â€¢ Takes longer to converge (50-100 epochs)                        â”‚
â”‚ â€¢ Good for initial training                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Starting from Custom Weights (fine-tuning)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ python train_vm.py --weights runs/.../best.pt --epochs 30         â”‚
â”‚                                                                    â”‚
â”‚ â€¢ Starts from your trained model                                  â”‚
â”‚ â€¢ Already knows wildlife detection                                â”‚
â”‚ â€¢ Converges faster (20-50 epochs)                                 â”‚
â”‚ â€¢ Good for improvements and experimentation                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ’¡ PRO TIPS

1. Save multiple checkpoints
   â†’ Use --save_period to save every N epochs
   â†’ Gives you multiple starting points to try

2. Experiment with different runs
   â†’ Run 1: Train from base model (50 epochs)
   â†’ Run 2: Fine-tune best.pt with different augmentation
   â†’ Run 3: Fine-tune best.pt with different image size

3. Use Wandb to compare
   â†’ Track all runs in Wandb
   â†’ Compare base model vs fine-tuned performance
   â†’ Identify best configuration

4. Keep backups
   â†’ Copy best.pt to safe location
   â†’ Rename with descriptive names:
     best_50epochs_2048px.pt
     best_finetuned_30epochs_1024px.pt

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ EXAMPLE WORKFLOW

Day 1: Initial Training
  python train_vm.py --epochs 50 --batch 4 --imgsz 2048
  â†’ Result: runs/yolov11_wildlife/weights/best.pt (mAP: 0.65)

Day 2: Fine-tune with more epochs
  python train_vm.py \
    --weights runs/yolov11_wildlife/weights/best.pt \
    --epochs 30 --batch 4 --imgsz 2048
  â†’ Result: runs/yolov11_wildlife2/weights/best.pt (mAP: 0.70) âœ…

Day 3: Try smaller image size for faster inference
  python train_vm.py \
    --weights runs/yolov11_wildlife2/weights/best.pt \
    --epochs 20 --batch 8 --imgsz 1024
  â†’ Result: runs/yolov11_wildlife3/weights/best.pt (mAP: 0.68)
  â†’ Keep yolov11_wildlife2 (best accuracy)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ COMPLETE COMMAND REFERENCE

python train_vm.py [OPTIONS]

Options:
  --weights PATH       Path to pretrained .pt file
  --epochs N           Number of epochs (default: 50)
  --batch N            Batch size (default: 4)
  --imgsz N            Image size (default: 2048)
  --no-wandb           Disable wandb logging
  --wandb-key KEY      Wandb API key

Examples:
  # Basic fine-tuning
  python train_vm.py --weights runs/.../best.pt

  # Full configuration
  python train_vm.py --weights runs/.../best.pt --epochs 30 --batch 4 --imgsz 2048

  # Quick test (5 epochs)
  python train_vm.py --weights runs/.../best.pt --epochs 5 --no-wandb

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… VERIFICATION

To verify custom weights are loaded:

1. Check output shows:
   âœ“ Using custom pretrained weights: [path]
   Loading model: [path]
     â†’ Fine-tuning from custom checkpoint

2. Training starts with reasonable initial metrics
   (not random, should be close to loaded model's performance)

3. Loss values start lower than training from scratch

4. mAP values in first epoch are reasonable (not 0)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Status: âœ… Feature Added
Last Updated: 2025-11-20
Version: 2.1

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Need more help?
  - See: COMPLETE_SETUP_GUIDE.md for full training guide
  - See: QUICK_START.txt for basic commands
  - See: README.md for documentation index

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

